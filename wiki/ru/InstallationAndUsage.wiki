#labels Featured,Phase-Deploy
==Установка==

Утилита распространяется как portable package, так что просто скачайте последнюю версию архива из [http://code.google.com/p/slowhttptest/downloads/list Downloads] секции, разархивируйте, сконфигурируйте, скомпилируйте, и  установите:
{{{
$ tar -xzvf slowhttptest-x.x.tar.gz

$ cd slowhttptest-x.x

$ ./configure –prefix=PREFIX

$ make

$ sudo make install
}}}
Где PREFIX нужно заменить на абсолютный путь к месту инсталляции slowhttptest-а.

Для успешной компиляции понадобится наличие libssl-dev. Большинство систем имеют этот пакет. 


==Использование==

Утилита может работать с параметрами по умолчанию, которые неагрессивны, и скорее всего не приведут к отказу в обслуживании. Введите:
{{{
$ PREFIX/bin/slowhttptest
}}}
и тест запустится со следующими параметрами по умолчанию:


||замедляемая секция||заголовки||
||количество соединений||50||
||URL||http://localhost/||
||метод||GET||
||интервал между дополнительными посылаемыми данными||10 секунд||
||соединений в секунду||50||
||длительность теста||240 секунд||
||Таймаут соединения для проб||5 секунд||
||максимальная длина имени или значения допольнителных данных||32 байта||

Для каждого соединения сгенерируется запрос, содержащий:
{{{
GET / HTTP/1.1
Host: localhost:80
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2)
}}}
 
Где user-agent случайно выбирается из списка на все время теста.

Далее, каждые 10 секунд посылается дополнительный заголовок со случайным именем и значением, каждое из которых случайного размера, не превышающий 32 байта:
{{{
X-HMzV2bwpzQw9jU9fGjIJyZRknd7Sa54J: u6RrIoLRrte4QV92yojeewiuDa9BL2N7
.
. 10 секунд
.
X-nq0HRGnv1W: T5dSL
.
. 10 секунд
.
X-iFrjuN: PdR7Jcj27P
.
.
}}}
 

Повторяется до тех пор, пока сервер не закроет соедниние или продолжительность теста не достигнет лимита, 240 секунд в данном случае.
Также программа создает соединение, проверяющее доступность ресурсов сервера каждую секунду, посылая полный GET запрос. Если сервер отвечает в течении заданного интервала (1 секунда, в данном случае, устанавливается ключом -p), сервер считается доступным, в противном слуачае считается что мы достигли отказа в обслуживании. Значение по умолчанию (5 секунд) может быть недостаточно долгим для медленных серверов, или если используется SSL соединение, и рекомендуется исполъзпвать сначение, близкое к среднему времени ответа сервера.

Полный список конфигурируемых параметров:

||-a значение||начальное значение заголовка диапазонов для теста диапазона||
||-b байты||лимит значения заголовка диапазонов для теста диапазона||
||-c количество соединений||лимит: 1024||
||-H, B, or R||указывает секцию HTTP запроса, которая будет замедляться -H заголовки, -B тело, -R тестирует диапазоны||
||-g||генерирует статистику в формате CSV и HTML в файлы, формат имени которых slow_xxx.csv/html, где xxx время и дата||
||-i секунды||интервал мехду замедленными данными в секундах||
||-l секунды||продолжительность теста в секундах||
||-o файл||путь и имя файлов статистики, работает при указании ключа -g||
||-p секунды||интервал ожидания ответа с сервера, при истечении которого считается что отказ в обслуживании наступил||
||-r соеднинений в секунду||скорость соединений||
||-s байт||значение заголовка Content-Length, если тест в режиме -B||
||-t метод||заголовок для использования в запросе, заданный пользователем||
||-u URL||адрес ресурса в формате, используемом в браузере, например: http[s]://host[:port]/||
||-v уровень||уровень детализации истории 0-4||
||-x байт||максимальная длина дополнительных данных||

Пример использования:
{{{
./slowhttptest -c 1000 -B -g -o my_server_stats -i 110 -r 200 -s 8192 -t FAKEVERB -u https://myseceureserver/resources/index.html -x 10 -p 3
}}}

==Выходные значения==

В зависимости от уровня детализации, содержание истории выполнения теста варьируется от статуса теста, генерируемого каждые 5 секунд при уровне деталиазции 1, до полного вывода траффика при уровне 4.

Опция -g сгенерирует CSV файл и интерактивный график в виде HTML страницы на основе Google Chart Tools с состоянием сервера в течении теста.
Пример HTML страницы с графиком состояния сервера:

[https://lh5.googleusercontent.com/-vU4CrGXWOKQ/ToEhHQXKP0I/AAAAAAAAA6g/7GV2rnidAVI/s800/nginx_new.png]


наглядно демонстрирующая состояния соединений с сервером и интервалы отказов в обслуживании.

CSV файлы могут быть использованы как входные данные для инструментов, генерирующих графики. (MS Excel, iWorks Numbers, Google Docs)
