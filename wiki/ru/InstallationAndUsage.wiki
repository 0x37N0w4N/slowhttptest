#labels Featured,Phase-Deploy
==Установка==

Утилита распространяется как portable package, так что просто скачайте последний архив из [http://code.google.com/p/slowhttptest/downloads/list Downloads] секции, разархивируйте, сконфигурируйте, скомпилируйте, и  установите:
{{{
$ tar -xzvf slowhttptest-x.x.tar.gz

$ cd slowhttptest-x.x

$ ./configure –prefix=PREFIX

$ make

$ sudo make install
}}}
Где PREFIX нужно заменить на абсолютный путь к месту инсталляции slowhttptest-а.

Для успешной компиляции понадобится наличие libssl-dev. Большинство систем имеют этот пакет. 


==Использование==

Утилита может работать с параметрами по умолчанию, которые неагрессивны, и скорее всего не приведут к отказу в обслуживании. Введите:
{{{
$ PREFIX/bin/slowhttptest
}}}
и тест запустится со следующими параметрами по умолчанию:


||slow section||headers||
||number of connections||50||
||URL||http://localhost/||
||verb||GET||
||interval between follow up data||10 seconds||
||connections per second||50||
||test duration||240 seconds||
||probe connection timeout||5 seconds||
||max length of followup data field||32 bytes||

Для каждого соединения сгенерируется запрос, содержащий:
{{{
GET / HTTP/1.1
Host: localhost:80
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2)
}}}
 
Где user-agent случайно выбирается из списка на все время теста.

Далее, каждые 10 секунд посылается дополнительный заголовок со случайным именем и значением, каждое из которых случайного размера, не превышающий 32 байта:
{{{
X-HMzV2bwpzQw9jU9fGjIJyZRknd7Sa54J: u6RrIoLRrte4QV92yojeewiuDa9BL2N7
.
. 10 секунд
.
X-nq0HRGnv1W: T5dSL
.
. 10 секунд
.
X-iFrjuN: PdR7Jcj27P
.
.
}}}
 

Повторяется до тех пор, пока сервер не закроет соедниние или продолжительность теста не достигнет лимита, 240 секунд в данном случае.
Также программа создает соединение, проверяющее доступность ресурсов сервера каждую секунду, посылая полный GET запрос. Если сервер отвечает в течении заданного интервала (1 секунда, в данном случае, устанавливается ключом -p), сервер считается доступным, в противном слуачае считается что мы достигли отказа в обслуживании. Значение по умолчанию (5 секунд) может быть недостаточно долгим для медленных серверов, или если используется SSL соединение, и рекомендуется исполъзпвать сначение, близкое к среднему времени ответа сервера.

Полный список конфигурируемых параметров:

||-a start||start value of ranges-specifier for range header test||
||-b bytes||limit of range-specifier for range header test||
||-c number of connections||limited to 1024||
||-H, B, or R||specify to slow down in headers section or in message body. -R enables range test||
||-g||generate statistics in CSV and HTML formats, pattern is slow_xxx.csv/html, where xxx is the time and date||
||-i seconds||interval between follow up data in seconds, per connection||
||-l seconds||test duration in seconds||
||-o file||custom output file path and/or name, effective if -g is specified||
||-p seconds||timeout to wait for HTTP response on probe connection, after which server is considered inaccessible||
||-r connections per second||connection rate||
||-s bytes||value of Content-Length header, if -B specified||
||-t verb||custom verb to use||
||-u URL||target URL, the same format you type in browser, e.g http[s]://host[:port]/||
||-v level||verbosity level of log 0-4||
||-x bytes||max length of follow up data||

Пример использвания:
{{{
./slowhttptest -c 1000 -B -g -o my_server_stats -i 110 -r 200 -s 8192 -t FAKEVERB -u https://myseceureserver/resources/index.html -x 10 -p 3
}}}

==Выходные значения==

В зависимости от уровня детализации, содержание истории выполнения теста варьируется от статуса теста, генерируемого каждые 5 секунд при уровне деталиазции 1, до полного вывода траффика при уровне 4.

Опция -g сгенерирует CSV файл и интерактивный график в виде HTML страницы на основе Google Chart Tools с состоянием сервера в течении теста.
Пример HTML страницы с графиком состояния сервера:

[https://lh5.googleusercontent.com/-vU4CrGXWOKQ/ToEhHQXKP0I/AAAAAAAAA6g/7GV2rnidAVI/s800/nginx_new.png]


наглядно демонстрирующая состояния соединений с сервером и интервалы отказов в обслуживании.

CSV файлы могут быть использованы как входные данные для инструментов, генерирующих графики. (MS Excel, iWorks Numbers, Google Docs)
